<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>業務委託基本契約書 - Hubble（初回共有）</title>
    <link rel="icon" href="favicon-32.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="hubble-design-tokens.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: var(--bg-note);
            color: var(--text-default);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* ===== ヘッダー ===== */
        .hubble-header {
            background: var(--color-white);
            border-bottom: 1px solid var(--border-default);
            padding: 0 var(--space-6);
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 56px;
        }

        .hubble-header-left {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .hubble-logo {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
        }

        .hubble-breadcrumb {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--font-size-sm);
            color: var(--text-assist);
        }

        .hubble-breadcrumb a {
            color: var(--text-assist);
            text-decoration: none;
        }

        .hubble-breadcrumb a:hover {
            color: var(--text-link);
        }

        .hubble-breadcrumb-current {
            color: var(--text-heading);
            font-weight: var(--font-weight-medium);
        }

        .hubble-header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .hubble-header-btn {
            padding: 8px 16px;
            background: var(--color-white);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: var(--text-default);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .hubble-header-btn:hover {
            background: var(--bg-hover);
        }

        .hubble-header-btn.primary {
            background: var(--color-primary);
            color: var(--color-white);
            border-color: var(--color-primary);
        }

        .hubble-header-btn.primary:hover {
            opacity: 0.9;
        }

        /* ===== ツールバー ===== */
        .hubble-toolbar {
            background: var(--color-white);
            border-bottom: 1px solid var(--border-default);
            padding: var(--space-2) var(--space-6);
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .hubble-toolbar-btn {
            padding: 6px;
            background: transparent;
            border: none;
            border-radius: var(--radius-sm);
            color: var(--text-assist);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .hubble-toolbar-btn:hover {
            background: var(--bg-hover);
            color: var(--text-default);
        }

        .hubble-toolbar-divider {
            width: 1px;
            height: 24px;
            background: var(--border-default);
        }

        .hubble-toolbar-spacer {
            flex: 1;
        }

        .hubble-toolbar-btn.share-nego {
            padding: 6px 12px;
            background: var(--color-white);
            color: var(--color-social);
            border: 1px solid var(--color-social);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            gap: var(--space-1);
        }

        .hubble-toolbar-btn.share-nego:hover {
            background: var(--color-social-container);
            color: var(--color-social);
        }

        .hubble-toolbar-btn.word-edit {
            padding: 6px 12px;
            background: var(--color-primary);
            color: var(--color-white);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            gap: var(--space-1);
        }

        .hubble-toolbar-btn.word-edit:hover {
            background: #1565C0;
            color: var(--color-white);
        }

        /* ===== メインコンテナ ===== */
        .hubble-main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* ===== 左サイドバー（バージョン） ===== */
        .hubble-sidebar {
            width: 200px;
            background: var(--color-white);
            border-right: 1px solid var(--border-default);
            display: flex;
            flex-direction: column;
        }

        .hubble-sidebar-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-default);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            color: var(--text-assist);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* バージョンリスト */
        .version-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-2) 0;
        }

        .version-item {
            display: flex;
            align-items: flex-start;
            padding: var(--space-2) var(--space-4);
            cursor: pointer;
            transition: background var(--transition-normal);
        }

        .version-item:hover {
            background: var(--bg-hover);
        }

        .version-item.selected {
            background: var(--color-primary-container);
        }

        .version-number-box {
            width: 32px;
            height: 32px;
            background: var(--bg-note);
            border: 2px solid var(--border-default);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
            color: var(--text-heading);
            margin-right: var(--space-3);
            flex-shrink: 0;
        }

        .version-item.selected .version-number-box {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: var(--color-white);
        }

        .version-info {
            flex: 1;
            min-width: 0;
        }

        .version-status {
            display: flex;
            align-items: center;
            gap: var(--space-1);
            font-size: 11px;
            margin-bottom: 2px;
        }

        .version-status-icon {
            font-size: 14px;
        }

        .version-status.sharing {
            color: var(--color-primary);
        }

        .version-status.shared {
            color: var(--text-assist);
        }

        .version-status.from-partner {
            color: var(--color-social);
        }

        .version-meta {
            font-size: 11px;
            color: var(--text-assist);
        }

        .version-comment-badge {
            display: inline-flex;
            align-items: center;
            gap: 2px;
            padding: 2px 6px;
            background: var(--bg-note);
            border-radius: var(--radius-full);
            font-size: 10px;
            color: var(--text-assist);
            margin-left: var(--space-2);
        }

        .version-comment-badge .material-symbols-outlined {
            font-size: 12px;
        }

        /* 交渉ステータス */
        .nego-status {
            padding: var(--space-4);
            border-top: 1px solid var(--border-default);
            background: var(--bg-note);
        }

        .nego-status-header {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            color: var(--text-assist);
            margin-bottom: var(--space-2);
        }

        .nego-status-content {
            font-size: var(--font-size-sm);
            color: var(--text-heading);
            line-height: 1.5;
        }

        .nego-status-line {
            margin-bottom: 2px;
        }

        .nego-status-line:last-child {
            color: var(--text-assist);
            font-size: var(--font-size-xs);
        }

        /* 共有ボタン */
        .share-to-nego-btn {
            width: 100%;
            margin-top: var(--space-3);
            padding: 10px var(--space-4);
            background: var(--color-primary);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--color-white);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }

        .share-to-nego-btn:hover {
            opacity: 0.9;
        }

        .share-to-nego-btn .material-symbols-outlined {
            font-size: 18px;
        }

        /* ===== 交渉ステータスバナー ===== */
        .nego-banner {
            background: var(--color-social-container);
            border-bottom: 1px solid #F5DCC8;
            padding: var(--space-2) var(--space-6);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nego-banner-content {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .nego-banner-icon {
            width: 32px;
            height: 32px;
            background: var(--color-social);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-white);
        }

        .nego-banner-icon .material-symbols-outlined {
            font-size: 18px;
        }

        .nego-banner-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .nego-banner-title {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--text-heading);
        }

        .nego-banner-status {
            font-size: var(--font-size-xs);
            color: var(--color-social);
        }

        .nego-banner-action {
            padding: 8px 16px;
            background: var(--color-social);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-white);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--space-2);
            text-decoration: none;
        }

        .nego-banner-action:hover {
            opacity: 0.9;
        }

        .nego-banner-action .material-symbols-outlined {
            font-size: 16px;
        }

        /* ===== メインコンテンツ（契約書） ===== */
        .hubble-content {
            flex: 1;
            background: var(--bg-note);
            overflow-y: auto;
            padding: var(--space-6);
        }

        .document-container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--color-white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            padding: var(--space-10);
        }

        .doc-main-title {
            text-align: center;
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-heading);
            margin-bottom: var(--space-4);
            letter-spacing: 0.5em;
            padding-left: 0.5em;
        }

        .doc-subtitle {
            text-align: center;
            font-size: var(--font-size-sm);
            color: var(--text-default);
            margin-bottom: var(--space-8);
        }

        .doc-preamble {
            font-size: var(--font-size-sm);
            color: var(--text-default);
            line-height: 1.8;
            margin-bottom: var(--space-8);
            text-indent: 1em;
        }

        .doc-article {
            margin-bottom: var(--space-6);
        }

        .article-title {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
            color: var(--text-heading);
            margin-bottom: var(--space-2);
        }

        .article-content {
            font-size: var(--font-size-sm);
            color: var(--text-default);
            line-height: 1.8;
        }

        /* 署名欄 */
        .contract-signature-section { margin-top: var(--space-10); padding-top: var(--space-8); }
        .contract-signature-closing { font-size: var(--font-size-sm); line-height: 2; color: var(--text-default); text-indent: 1em; margin-bottom: var(--space-8); }
        .contract-signature-date { font-size: var(--font-size-sm); color: var(--text-default); text-align: right; margin-bottom: var(--space-10); letter-spacing: 0.3em; }
        .contract-signature-block { display: flex; flex-direction: column; gap: var(--space-8); padding-left: 20%; }
        .contract-signature-party { display: flex; flex-direction: column; }
        .contract-party-heading { font-size: var(--font-size-sm); font-weight: var(--font-weight-bold); color: var(--text-heading); margin-bottom: var(--space-2); letter-spacing: 0.2em; }
        .contract-party-row { display: flex; align-items: center; font-size: var(--font-size-sm); line-height: 2; color: var(--text-default); }
        .contract-party-label { width: 56px; flex-shrink: 0; color: var(--text-assist); font-size: 12px; letter-spacing: 0.1em; }
        .contract-party-value { flex: 1; }

        /* ===== 右サイドバー（コメント） ===== */
        .hubble-comments {
            width: 360px;
            background: var(--color-white);
            border-left: 1px solid var(--border-default);
            display: flex;
            flex-direction: column;
        }

        .comments-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-default);
        }

        .comments-title {
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-semibold);
            color: var(--text-heading);
        }

        .comments-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-assist);
            cursor: pointer;
        }

        .comments-enter-hint {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--font-size-xs);
            color: var(--text-assist);
        }

        .comments-enter-hint input[type="checkbox"] {
            width: 14px;
            height: 14px;
        }

        /* コメントタブ */
        .comments-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-default);
        }

        .comments-tab {
            flex: 1;
            padding: var(--space-3) var(--space-4);
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--text-assist);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .comments-tab:hover {
            color: var(--text-heading);
        }

        .comments-tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        /* コメントリスト */
        .comments-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-4);
            background: var(--color-white);
        }

        .comments-version-label {
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            color: var(--text-assist);
            margin-bottom: var(--space-3);
            text-align: center;
            padding: var(--space-2) var(--space-3);
            background: var(--color-white);
            border-radius: var(--radius-full);
            display: inline-block;
            width: 100%;
        }

        /* コメント - 共通 */
        .comment-item {
            display: flex;
            flex-direction: column;
            margin-bottom: var(--space-4);
        }

        .comment-item-header {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-1);
        }

        .comment-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: var(--font-weight-semibold);
            flex-shrink: 0;
        }

        .comment-avatar.internal {
            background: var(--color-primary);
            color: var(--color-white);
        }

        .comment-avatar.external {
            background: var(--color-social);
            color: var(--color-white);
        }

        .comment-author {
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            color: var(--text-heading);
        }

        .comment-time {
            font-size: 10px;
            color: var(--text-assist);
        }

        .comment-bubble {
            font-size: var(--font-size-sm);
            color: var(--text-default);
            line-height: 1.6;
        }

        /* 社内コメント - 囲みなし */
        .comment-item.internal {
            align-items: flex-start;
        }

        .comment-item.internal .comment-bubble {
            background: transparent;
        }

        /* 交渉コメント - オレンジ縦線 + オレンジ背景 */
        .comment-item.external {
            align-items: flex-start;
        }

        .comment-item.external .comment-bubble {
            background: var(--color-social-container);
            border-left: 3px solid var(--color-social);
            padding: var(--space-3);
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
        }

        .comment-item.external .nego-reply-link {
            display: inline-flex;
            align-items: center;
            gap: var(--space-1);
            margin-top: var(--space-2);
            padding: 4px 10px;
            background: var(--color-white);
            border: 1px solid var(--color-social);
            border-radius: var(--radius-full);
            font-size: 10px;
            font-weight: var(--font-weight-medium);
            color: var(--color-social);
            text-decoration: none;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .comment-item.external .nego-reply-link:hover {
            background: var(--color-social-container);
        }

        /* 削除されたコメント */
        .comment-item.deleted .comment-bubble {
            background: var(--bg-note);
            border-color: var(--border-default);
        }

        .comment-deleted-notice {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2);
            background: rgba(0,0,0,0.05);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            color: var(--text-assist);
            margin-bottom: var(--space-2);
        }

        .comment-deleted-toggle {
            font-size: 10px;
            color: var(--text-link);
            cursor: pointer;
            margin-top: var(--space-1);
        }

        .comment-deleted-original {
            display: none;
            padding: var(--space-2);
            background: rgba(0,0,0,0.03);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            color: var(--text-assist);
            margin-top: var(--space-2);
        }

        .comment-deleted-original.show {
            display: block;
        }

        /* コメント入力 */
        .comments-input {
            padding: var(--space-4);
            border-top: 1px solid var(--border-default);
            background: var(--color-white);
        }

        .comments-input-area {
            padding: var(--space-3);
            background: var(--bg-input);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: var(--text-assist);
            min-height: 60px;
        }

        /* ===== 共有確認モーダル ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: var(--color-white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            width: 480px;
            max-width: 90vw;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-4) var(--space-6);
            border-bottom: 1px solid var(--border-default);
        }

        .modal-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--text-heading);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-assist);
            cursor: pointer;
        }

        .modal-body {
            padding: var(--space-6);
        }

        .share-version-label {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--text-heading);
            margin-bottom: var(--space-3);
        }

        .share-documents-list {
            background: var(--bg-note);
            border-radius: var(--radius-md);
            padding: var(--space-3);
            margin-bottom: var(--space-4);
        }

        .share-document-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) 0;
            font-size: var(--font-size-sm);
            color: var(--text-default);
        }

        .share-document-item .material-symbols-outlined {
            font-size: 18px;
            color: var(--text-assist);
        }

        .share-document-version {
            margin-left: auto;
            font-size: var(--font-size-xs);
            color: var(--text-assist);
        }

        .share-warning {
            display: flex;
            align-items: flex-start;
            gap: var(--space-2);
            padding: var(--space-3);
            background: #FFF8E1;
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: #856404;
        }

        .share-warning .material-symbols-outlined {
            font-size: 20px;
            color: #F9A825;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: var(--space-3);
            padding: var(--space-4) var(--space-6);
            border-top: 1px solid var(--border-default);
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .modal-btn.cancel {
            background: var(--color-white);
            border: 1px solid var(--border-default);
            color: var(--text-default);
        }

        .modal-btn.cancel:hover {
            background: var(--bg-hover);
        }

        .modal-btn.primary {
            background: var(--color-primary);
            border: none;
            color: var(--color-white);
        }

        .modal-btn.primary:hover {
            opacity: 0.9;
        }

        .modal-btn.primary:disabled {
            background: var(--bg-note);
            color: var(--text-assist);
            cursor: not-allowed;
            opacity: 1;
        }

        /* ===== 招待モーダル用スタイル ===== */
        .invite-role-note {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--bg-note);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: var(--text-assist);
        }

        .invite-emails-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            margin-bottom: var(--space-2);
        }

        .invite-email-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            background: var(--bg-note);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
        }

        .invite-email-item .material-symbols-outlined {
            font-size: 16px;
            color: var(--text-assist);
        }

        .invite-email-text {
            flex: 1;
            color: var(--text-default);
        }

        .invite-email-remove {
            background: none;
            border: none;
            color: var(--text-assist);
            cursor: pointer;
            padding: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .invite-email-remove:hover {
            color: var(--color-danger);
        }

        .invite-email-input-row {
            display: flex;
            gap: var(--space-2);
        }

        .invite-email-input {
            flex: 1;
            padding: var(--space-2) var(--space-3);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            outline: none;
            transition: border-color var(--transition-normal);
        }

        .invite-email-input:focus {
            border-color: var(--color-social);
        }

        .invite-add-email-btn {
            width: 36px;
            height: 36px;
            background: var(--color-social);
            border: none;
            border-radius: var(--radius-md);
            color: var(--color-white);
            font-size: 20px;
            cursor: pointer;
            transition: opacity var(--transition-normal);
        }

        .invite-add-email-btn:hover {
            opacity: 0.9;
        }

        .invite-divider {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            margin: var(--space-4) 0;
            color: var(--text-assist);
            font-size: var(--font-size-xs);
        }

        .invite-divider::before,
        .invite-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border-default);
        }

        .invite-link-row {
            display: flex;
            gap: var(--space-2);
        }

        .invite-link-input {
            flex: 1;
            padding: var(--space-2) var(--space-3);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: var(--text-assist);
            background: var(--bg-note);
            outline: none;
        }

        .invite-copy-btn {
            padding: var(--space-2) var(--space-3);
            background: var(--color-white);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: var(--text-default);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-1);
            transition: all var(--transition-normal);
        }

        .invite-copy-btn:hover {
            background: var(--bg-hover);
        }

        .invite-link-note {
            display: flex;
            align-items: flex-start;
            gap: var(--space-1);
            margin-top: var(--space-2);
            font-size: var(--font-size-xs);
            color: var(--text-assist);
        }

        .invite-link-note .material-symbols-outlined {
            font-size: 14px;
            color: #F9A825;
        }

        /* ===== トースト通知 ===== */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-inverse);
            color: var(--color-white);
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transition: all var(--transition-normal);
            z-index: 2000;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- ヘッダー -->
    <header class="hubble-header">
        <div class="hubble-header-left">
            <div class="hubble-logo">Hubble</div>
            <div class="hubble-breadcrumb">
                <a href="#">ドキュメント</a>
                <span class="material-symbols-outlined icon-xs">chevron_right</span>
                <a href="#">XYZ社案件</a>
                <span class="material-symbols-outlined icon-xs">chevron_right</span>
                <span class="hubble-breadcrumb-current">業務委託基本契約書</span>
            </div>
        </div>
    </header>

    <!-- ツールバー -->
    <div class="hubble-toolbar">
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">refresh</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">download</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">upload</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">print</span></button>
        <div class="hubble-toolbar-divider"></div>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">visibility</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">search</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">zoom_in</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">zoom_out</span></button>
        <div class="hubble-toolbar-divider"></div>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">link</span></button>
        <button class="hubble-toolbar-btn"><span class="material-symbols-outlined icon-sm">task_alt</span></button>
        <div class="hubble-toolbar-spacer"></div>
        <button class="hubble-toolbar-btn share-nego" onclick="openShareModal()">
            <span class="material-symbols-outlined icon-sm">send</span>
            交渉相手に共有
        </button>
        <button class="hubble-toolbar-btn word-edit">
            <span class="material-symbols-outlined icon-sm">edit</span>
            Wordで編集
        </button>
    </div>

    <!-- メインコンテナ -->
    <div class="hubble-main">
        <!-- 左サイドバー（バージョン管理） -->
        <aside class="hubble-sidebar">
            <div class="hubble-sidebar-header">Ver.</div>

            <div class="version-list">
                <div class="version-item selected" onclick="selectVersion(this)">
                    <div class="version-number-box">3</div>
                    <div class="version-info">
                        <div class="version-meta">1/28 14:15</div>
                    </div>
                </div>
                <div class="version-item" onclick="selectVersion(this)">
                    <div class="version-number-box">2</div>
                    <div class="version-info">
                        <div class="version-meta">1/27 11:30</div>
                    </div>
                </div>
                <div class="version-item" onclick="selectVersion(this)">
                    <div class="version-number-box">1</div>
                    <div class="version-info">
                        <div class="version-meta">1/25 10:00</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- メインコンテンツ -->
        <main class="hubble-content">
            <div class="document-container">
                <div class="doc-main-title">業務委託基本契約書</div>

                <div class="doc-preamble">
                    株式会社ABC（以下「甲」という）と株式会社XYZ（以下「乙」という）は、甲が乙に委託する業務に関し、以下のとおり業務委託基本契約（以下「本契約」という）を締結する。
                </div>

                <div class="doc-article">
                    <div class="article-title">第1条（目的）</div>
                    <div class="article-content">
                        本契約は、甲が乙に対してデジタルマーケティング支援業務（以下「本業務」という）を委託し、乙がこれを受託するにあたり、甲乙間の権利義務関係を定めることを目的とする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第2条（業務内容）</div>
                    <div class="article-content">
                        1. 乙が甲に提供する本業務の具体的内容は、以下のとおりとする。<br>
                        （1）Webサイトの運用・改善提案<br>
                        （2）SNSマーケティング戦略の立案・実行<br>
                        （3）広告運用（リスティング広告、SNS広告等）<br>
                        （4）月次レポートの作成・報告<br>
                        （5）その他、上記に付随する業務<br>
                        2. 業務の詳細については、別途個別契約にて定めるものとする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第3条（契約期間）</div>
                    <div class="article-content">
                        1. 本契約の有効期間は、2026年2月1日から6ヶ月間とする。<br>
                        2. 本契約は、期間満了の2ヶ月前までに当事者いずれからも書面による別段の意思表示がない場合には、同一条件にて6ヶ月間自動的に更新されるものとし、以後も同様とする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第4条（報酬）</div>
                    <div class="article-content">
                        1. 甲は乙に対し、本業務の対価として、月額金48万円（消費税別）を支払うものとする。<br>
                        2. 報酬の支払いは、毎月末日締め、翌月末日払いとする。<br>
                        3. 振込手数料は甲の負担とする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第5条（経費）</div>
                    <div class="article-content">
                        本業務の遂行に必要な経費のうち、広告出稿費用その他甲が事前に承認した費用については、甲が実費を負担するものとする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第6条（秘密保持）</div>
                    <div class="article-content">
                        1. 甲及び乙は、本契約に関連して知り得た相手方の技術上、営業上その他の秘密情報を、相手方の事前の書面による承諾なく第三者に開示・漏洩してはならない。<br>
                        2. 前項の義務は、本契約終了後3年間存続するものとする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第7条（知的財産権）</div>
                    <div class="article-content">
                        1. 本業務の遂行により生じた成果物に関する著作権その他の知的財産権は、報酬の支払い完了をもって甲に帰属するものとする。<br>
                        2. 乙は、成果物について著作者人格権を行使しないものとする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第8条（再委託）</div>
                    <div class="article-content">
                        乙は、甲の事前の書面による承諾を得ることなく、本業務の全部又は一部を第三者に再委託してはならない。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第9条（契約解除）</div>
                    <div class="article-content">
                        1. 甲又は乙は、相手方が次の各号のいずれかに該当した場合、何らの催告なく直ちに本契約を解除することができる。<br>
                        （1）本契約に違反し、相当期間を定めて催告しても是正されないとき<br>
                        （2）支払停止又は支払不能となったとき<br>
                        （3）破産手続開始、民事再生手続開始、会社更生手続開始の申立てがあったとき<br>
                        （4）差押え、仮差押え、仮処分又は競売の申立てがあったとき<br>
                        （5）解散又は営業停止となったとき<br>
                        2. 前項により本契約が解除された場合、解除された当事者は、相手方に対し、損害賠償責任を負うものとする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第10条（損害賠償）</div>
                    <div class="article-content">
                        甲又は乙は、本契約に違反して相手方に損害を与えた場合、その損害を賠償する責任を負う。ただし、損害賠償の累計額は、本契約に基づき甲が乙に支払った報酬の総額を上限とする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第11条（反社会的勢力の排除）</div>
                    <div class="article-content">
                        1. 甲及び乙は、自己又は自己の役員が、暴力団、暴力団員、暴力団関係企業、総会屋その他の反社会的勢力（以下「反社会的勢力」という）に該当しないことを表明し、保証する。<br>
                        2. 甲又は乙は、相手方が前項に違反した場合、何らの催告なく直ちに本契約を解除することができる。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第12条（権利義務の譲渡禁止）</div>
                    <div class="article-content">
                        甲及び乙は、相手方の事前の書面による承諾なく、本契約上の地位又は本契約に基づく権利義務の全部若しくは一部を第三者に譲渡し、又は担保に供してはならない。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第13条（協議事項）</div>
                    <div class="article-content">
                        本契約に定めのない事項又は本契約の解釈に疑義が生じた事項については、甲乙誠意をもって協議し、解決するものとする。
                    </div>
                </div>

                <div class="doc-article">
                    <div class="article-title">第14条（管轄裁判所）</div>
                    <div class="article-content">
                        本契約に関する一切の紛争については、東京地方裁判所を第一審の専属的合意管轄裁判所とする。
                    </div>
                </div>

                <!-- 署名欄（交渉中のため印なし） -->
                <div class="contract-signature-section">
                    <div class="contract-signature-closing">
                        本契約締結の証として、本書2通を作成し、甲乙記名押印のうえ、各1通を保有する。
                    </div>
                    <div class="contract-signature-date">
                        2026年　　月　　日
                    </div>

                    <div class="contract-signature-block">
                        <div class="contract-signature-party">
                            <div class="contract-party-heading">甲</div>
                            <div class="contract-party-row">
                                <span class="contract-party-label">住　所</span>
                                <span class="contract-party-value">東京都渋谷区○○1-2-3</span>
                            </div>
                            <div class="contract-party-row">
                                <span class="contract-party-label">会社名</span>
                                <span class="contract-party-value">株式会社ABC</span>
                            </div>
                            <div class="contract-party-row signer-row">
                                <span class="contract-party-label">代表者</span>
                                <span class="contract-party-value">代表取締役　佐藤 一郎</span>
                            </div>
                        </div>

                        <div class="contract-signature-party">
                            <div class="contract-party-heading">乙</div>
                            <div class="contract-party-row">
                                <span class="contract-party-label">住　所</span>
                                <span class="contract-party-value">東京都港区△△4-5-6</span>
                            </div>
                            <div class="contract-party-row">
                                <span class="contract-party-label">会社名</span>
                                <span class="contract-party-value">株式会社XYZ</span>
                            </div>
                            <div class="contract-party-row signer-row">
                                <span class="contract-party-label">代表者</span>
                                <span class="contract-party-value">代表取締役　田中 太郎</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 右サイドバー（コメント） -->
        <aside class="hubble-comments">
            <div class="comments-header">
                <span class="comments-title">コメント</span>
                <div class="comments-enter-hint">
                    <input type="checkbox" id="enterSubmit">
                    <label for="enterSubmit">Enterで送信する</label>
                </div>
            </div>

            <div class="comments-tabs">
                <button class="comments-tab active" onclick="switchTab(this, 'all')">全体</button>
                <button class="comments-tab" onclick="switchTab(this, 'legal')">法務</button>
            </div>

            <div class="comments-list">
                <div class="comments-version-label">Ver.3 のコメント</div>

                <!-- 社内コメント -->
                <div class="comment-item internal">
                    <div class="comment-item-header">
                        <div class="comment-avatar internal">田</div>
                        <span class="comment-author">田中（法務）</span>
                        <span class="comment-time">1/28 11:30</span>
                    </div>
                    <div class="comment-bubble">
                        レビュー完了しました。3条と7条を修正しています。先方に送って大丈夫です。
                    </div>
                </div>

                <!-- 社内コメント -->
                <div class="comment-item internal">
                    <div class="comment-item-header">
                        <div class="comment-avatar internal">山</div>
                        <span class="comment-author">山本（営業）</span>
                        <span class="comment-time">1/28 10:00</span>
                    </div>
                    <div class="comment-bubble">
                        @田中さん 先方との打ち合わせで合意した内容を反映しました。法務レビューお願いします。
                    </div>
                </div>

                <div class="comments-version-label" style="margin-top: var(--space-4);">Ver.2 のコメント</div>

                <!-- 社内コメント -->
                <div class="comment-item internal">
                    <div class="comment-item-header">
                        <div class="comment-avatar internal">田</div>
                        <span class="comment-author">田中（法務）</span>
                        <span class="comment-time">1/27 15:00</span>
                    </div>
                    <div class="comment-bubble">
                        初稿を確認しました。いくつか修正が必要な箇所があります。
                    </div>
                </div>
            </div>

            <div class="comments-input">
                <div class="comments-input-area">
                    @を入力して送信する相手を指定してコメントしてください。
                </div>
            </div>
        </aside>
    </div>

    <!-- 初回共有モーダル -->
    <div class="modal-overlay" id="shareModal">
        <div class="modal-content" style="width: 560px;">
            <div class="modal-header">
                <div class="modal-title">
                    <span class="material-symbols-outlined">group_add</span>
                    交渉相手を招待
                </div>
                <button class="modal-close" onclick="closeShareModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--space-5) var(--space-6);">
                <!-- 共有するバージョン情報 -->
                <div style="margin-bottom: var(--space-5);">
                    <div class="share-version-label">共有するバージョン</div>
                    <div class="share-documents-list" style="margin-bottom: 0;">
                        <div class="share-document-item">
                            <span class="material-symbols-outlined">description</span>
                            業務委託基本契約書
                            <span class="share-document-version">Ver.3（最新）</span>
                        </div>
                    </div>
                </div>

                <!-- 権限表示 -->
                <div style="margin-bottom: var(--space-5);">
                    <div class="share-version-label">この相手の権限</div>
                    <div class="invite-role-note">
                        <span class="material-symbols-outlined" style="font-size: 18px; color: var(--text-assist);">edit</span>
                        <span>編集者（閲覧・編集・コメントが可能）</span>
                    </div>
                </div>

                <!-- メールアドレスで招待 -->
                <div style="margin-bottom: var(--space-4);">
                    <div class="share-version-label">メールアドレスで招待</div>
                    <div class="invite-emails-list" id="inviteEmailsList">
                        <!-- 招待メールリストがここに表示される -->
                    </div>
                    <div class="invite-email-input-row">
                        <input type="email" class="invite-email-input" id="inviteEmailInput" placeholder="メールアドレスを入力...">
                        <button class="invite-add-email-btn" onclick="addInviteEmail()">+</button>
                    </div>
                </div>

                <!-- 区切り線 -->
                <div class="invite-divider">
                    <span>または</span>
                </div>

                <!-- 招待リンク -->
                <div>
                    <div class="share-version-label"><span class="material-symbols-outlined icon-sm" style="vertical-align: middle;">link</span> 招待リンクをコピー</div>
                    <div class="invite-link-row">
                        <input type="text" class="invite-link-input" id="inviteLinkInput" value="https://nego.app/join/x7k2mP9qL..." readonly>
                        <button class="invite-copy-btn" onclick="copyInviteLink()"><span class="material-symbols-outlined icon-sm">content_copy</span> コピー</button>
                    </div>
                    <p class="invite-link-note"><span class="material-symbols-outlined icon-sm">lightbulb</span> 招待された方は契約書を閲覧できます。編集・合意にはサインインが必要です。</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeShareModal()">キャンセル</button>
                <button class="modal-btn primary" style="background: var(--color-social);" onclick="confirmShare()" id="inviteSubmitBtn">
                    <span class="material-symbols-outlined" style="font-size: 18px;">send</span>
                    <span id="inviteSubmitLabel">交渉を開始</span>
                </button>
            </div>
        </div>
    </div>

    <!-- トースト -->
    <div class="toast" id="toast">交渉相手に共有しました</div>

    <script>
        // 招待メールリスト
        let inviteEmails = [];

        // バージョン選択
        function selectVersion(item) {
            document.querySelectorAll('.version-item').forEach(v => v.classList.remove('selected'));
            item.classList.add('selected');
        }

        // コメントタブ切り替え
        function switchTab(tab, type) {
            document.querySelectorAll('.comments-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        }

        // 削除されたコメントの表示切り替え
        function toggleDeletedComment(toggle) {
            const original = toggle.nextElementSibling;
            original.classList.toggle('show');
            toggle.textContent = original.classList.contains('show') ? '▲ 閉じる' : '▼ 元の内容を表示';
        }

        // 共有モーダル
        function openShareModal() {
            document.getElementById('shareModal').classList.add('show');
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.remove('show');
            // モーダルをリセット
            inviteEmails = [];
            renderInviteEmails();
            document.getElementById('inviteEmailInput').value = '';
            updateInviteSubmitButton();
        }

        // メールアドレス追加
        function addInviteEmail() {
            const input = document.getElementById('inviteEmailInput');
            const email = input.value.trim();

            if (email && isValidEmail(email) && !inviteEmails.includes(email)) {
                inviteEmails.push(email);
                renderInviteEmails();
                input.value = '';
                updateInviteSubmitButton();
            }
        }

        // メールアドレス削除
        function removeInviteEmail(email) {
            inviteEmails = inviteEmails.filter(e => e !== email);
            renderInviteEmails();
            updateInviteSubmitButton();
        }

        // メールリスト描画
        function renderInviteEmails() {
            const list = document.getElementById('inviteEmailsList');
            if (inviteEmails.length === 0) {
                list.innerHTML = '';
                return;
            }

            list.innerHTML = inviteEmails.map(email => `
                <div class="invite-email-item">
                    <span class="material-symbols-outlined">mail</span>
                    <span class="invite-email-text">${email}</span>
                    <button class="invite-email-remove" onclick="removeInviteEmail('${email}')">
                        <span class="material-symbols-outlined icon-sm">close</span>
                    </button>
                </div>
            `).join('');
        }

        // メール形式チェック
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // 送信ボタンラベル更新
        function updateInviteSubmitButton() {
            const label = document.getElementById('inviteSubmitLabel');
            label.textContent = inviteEmails.length > 0 ? '招待して交渉を開始' : '交渉を開始';
        }

        // 招待リンクコピー
        function copyInviteLink() {
            const input = document.getElementById('inviteLinkInput');
            input.select();
            document.execCommand('copy');
            showToast('招待リンクをコピーしました');
        }

        // Enterキーでメール追加
        document.addEventListener('DOMContentLoaded', function() {
            const emailInput = document.getElementById('inviteEmailInput');
            if (emailInput) {
                emailInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addInviteEmail();
                    }
                });
            }
        });

        function confirmShare() {
            const hasEmails = inviteEmails.length > 0;
            closeShareModal();
            showToast(hasEmails ? '招待を送信しました！Negoに移動します...' : '交渉を開始しました！Negoに移動します...');
            setTimeout(() => {
                window.location.href = 'hubble-ui.html';
            }, 1500);
        }

        // トースト表示
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // モーダル外クリックで閉じる
        document.getElementById('shareModal').addEventListener('click', function(e) {
            if (e.target === this) closeShareModal();
        });
    </script>
</body>
</html>
